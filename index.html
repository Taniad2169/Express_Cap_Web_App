<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Express Capital Associates Application</title>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <style>
        /* ADDED FOR SMOOTH SCROLLING */
        html {
            scroll-behavior: smooth;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: white;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        .header-banner {
            background-color: #24345e;
            color: white;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }

        .header-banner h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .header-banner h2 {
            font-size: 1.3em;
            font-weight: normal;
            font-style: italic;
        }

        .page-section {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease-in;
        }

        .page-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            color: #24345e;
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #24345e;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .form-row.full {
            grid-template-columns: 1fr;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            color: #24345e;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        input[type="text"],
        input[type="tel"],
        input[type="email"],
        input[type="date"],
        input[type="number"],
        input[type="url"],
        select,
        textarea {
            width: 100%;
            padding: 14px 18px;
            border: 3px solid #24345e;
            background-color: #e1e3e8;
            border-radius: 8px;
            font-size: 1em;
            color: #24345e;
            box-shadow: inset 4px 4px 8px rgba(0,0,0,0.2), 
                        inset -4px -4px 8px rgba(255,255,255,0.7),
                        2px 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #24345e;
            box-shadow: inset 5px 5px 10px rgba(0,0,0,0.25), 
                        inset -5px -5px 10px rgba(255,255,255,0.8),
                        0 0 0 3px rgba(36, 52, 94, 0.15);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2324345e' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .radio-option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .radio-option label {
            margin: 0;
            cursor: pointer;
        }

        .animated-banner {
            background: linear-gradient(90deg, #ff4444, #ff6b6b, #ff4444);
            background-size: 200% 100%;
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 30px 0;
            animation: gradientShift 3s ease infinite;
            border: 3px solid #cc0000;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .animated-banner h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .animated-banner p {
            font-size: 1.1em;
        }

        .pointer {
            font-size: 2em;
            animation: point 1s ease-in-out infinite;
        }

        @keyframes point {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .upload-section {
            padding: 25px;
            background-color: white;
            border: 3px solid #24345e;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .upload-item {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #e1e3e8;
            border-radius: 6px;
            border: 2px solid #24345e;
        }

        .upload-item label {
            display: block;
            margin-bottom: 10px;
        }

        input[type="file"] {
            width: 100%;
            padding: 8px;
            border: 2px solid #24345e;
            border-radius: 4px;
            background-color: white;
            color: #24345e;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .checkbox-container input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            cursor: pointer;
        }

        .checkbox-container label {
            margin: 0;
            font-weight: normal;
            cursor: pointer;
        }

        .disclaimer-text {
            color: #24345e;
            line-height: 1.8;
            font-size: 0.95em;
            margin-bottom: 20px;
            text-align: justify;
            padding: 20px;
            background-color: #e1e3e8;
            border-radius: 8px;
        }

        .acknowledge-checkbox {
            display: flex;
            align-items: flex-start;
            margin: 20px 0;
            padding: 15px;
            background-color: #e1e3e8;
            border-radius: 6px;
            border: 2px solid #24345e;
        }

        .acknowledge-checkbox input[type="checkbox"] {
            width: 22px;
            height: 22px;
            margin-right: 12px;
            cursor: pointer;
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* NEW SIGNATURE PAD STYLING */
        .signature-section {
            margin-top: 20px;
            padding: 20px;
            background-color: #e1e3e8;
            border-radius: 6px;
            border: 2px solid #24345e;
        }

        .signature-section h4 {
            color: #24345e;
            margin-bottom: 15px;
        }

        #signaturePadContainer {
            border: 2px solid #24345e;
            background-color: white;
            border-radius: 6px;
            cursor: crosshair;
            display: none; /* Controlled by JS based on checkbox */
            width: 100%;
            height: 200px;
            margin-top: 15px;
            position: relative; /* Needed for canvas sizing */
        }

        #signatureCanvas {
            width: 100%;
            height: 100%;
            border-radius: 4px;
        }

        .signature-required {
            color: red;
            font-size: 0.9em;
            margin-top: 5px;
            display: none;
        }
        /* END NEW SIGNATURE PAD STYLING */

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        button {
            padding: 12px 30px;
            background-color: #24345e;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        button:hover {
            background-color: #1a2644;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .success-message {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: #4CAF50;
            color: white;
            border-radius: 6px;
            text-align: center;
            font-size: 1.1em;
        }

        .page-indicator {
            text-align: center;
            margin-bottom: 20px;
            color: #24345e;
            font-weight: 600;
        }

        .website-field {
            display: none;
            margin-top: 15px;
        }

        .url-input-container {
            display: flex;
            align-items: center;
        }

        .url-prefix {
            padding: 14px 10px;
            background-color: #d1d5e0;
            border: 3px solid #24345e;
            border-right: none;
            border-radius: 8px 0 0 8px;
            color: #24345e;
            font-weight: 600;
        }

        .url-input {
            border-radius: 0 8px 8px 0 !important;
        }

        @media print {
            .action-buttons,
            .navigation-buttons,
            button {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-banner">
            <h1>Express Capital Associates</h1>
            <h2>Soaring Above the Competition</h2>
        </div>

        <form id="applicationForm" action="https://formspree.io/f/xzzjgdyk" method="POST" enctype="multipart/form-data">
            
            <div class="page-section active" id="page1">
                <div class="page-indicator">Page 1 of 6</div>
                <h2 class="section-title">BUSINESS INFORMATION</h2>

                <div class="form-group">
                    <label for="todayDate">Today's Date *</label>
                    <input type="date" id="todayDate" name="today_date" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="legalName">Legal Corporate Name *</label>
                        <input type="text" id="legalName" name="legal_name" required>
                    </div>
                    <div class="form-group">
                        <label for="dbaName">DBA (Doing Business As) *</label>
                        <input type="text" id="dbaName" name="dba_name" required>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label for="physicalAddress">Physical Address *</label>
                        <input type="text" id="physicalAddress" name="physical_address" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="city">City *</label>
                        <input type="text" id="city" name="city" required>
                    </div>
                    <div class="form-group">
                        <label for="state">State *</label>
                        <select id="state" name="state" required>
                            <option value="">Select State</option>
                            <option value="AL">Alabama</option>
                            <option value="AK">Alaska</option>
                            <option value="AZ">Arizona</option>
                            <option value="AR">Arkansas</option>
                            <option value="CA">California</option>
                            <option value="CO">Colorado</option>
                            <option value="CT">Connecticut</option>
                            <option value="DE">Delaware</option>
                            <option value="FL">Florida</option>
                            <option value="GA">Georgia</option>
                            <option value="HI">Hawaii</option>
                            <option value="ID">Idaho</option>
                            <option value="IL">Illinois</option>
                            <option value="IN">Indiana</option>
                            <option value="IA">Iowa</option>
                            <option value="KS">Kansas</option>
                            <option value="KY">Kentucky</option>
                            <option value="LA">Louisiana</option>
                            <option value="ME">Maine</option>
                            <option value="MD">Maryland</option>
                            <option value="MA">Massachusetts</option>
                            <option value="MI">Michigan</option>
                            <option value="MN">Minnesota</option>
                            <option value="MS">Mississippi</option>
                            <option value="MO">Missouri</option>
                            <option value="MT">Montana</option>
                            <option value="NE">Nebraska</option>
                            <option value="NV">Nevada</option>
                            <option value="NH">New Hampshire</option>
                            <option value="NJ">New Jersey</option>
                            <option value="NM">New Mexico</option>
                            <option value="NY">New York</option>
                            <option value="NC">North Carolina</option>
                            <option value="ND">North Dakota</option>
                            <option value="OH">Ohio</option>
                            <option value="OK">Oklahoma</option>
                            <option value="OR">Oregon</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="RI">Rhode Island</option>
                            <option value="SC">South Carolina</option>
                            <option value="SD">South Dakota</option>
                            <option value="TN">Tennessee</option>
                            <option value="TX">Texas</option>
                            <option value="UT">Utah</option>
                            <option value="VT">Vermont</option>
                            <option value="VA">Virginia</option>
                            <option value="WA">Washington</option>
                            <option value="WV">West Virginia</option>
                            <option value="WI">Wisconsin</option>
                            <option value="WY">Wyoming</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="zip">Zip *</label>
                        <input type="text" id="zip" name="zip" required>
                    </div>
                    <div class="form-group">
                        <label for="businessPhone">Telephone Number *</label>
                        <input type="tel" id="businessPhone" name="business_phone" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="federalTaxId">Federal Tax ID *</label>
                        <input type="text" id="federalTaxId" name="federal_tax_id" required>
                    </div>
                    <div class="form-group">
                        <label for="dateStarted">Date Business Started *</label>
                        <input type="date" id="dateStarted" name="date_started" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>Do you have a website? *</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="websiteYes" name="has_website" value="yes" required>
                            <label for="websiteYes">Yes</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="websiteNo" name="has_website" value="no">
                            <label for="websiteNo">No</label>
                        </div>
                    </div>
                </div>

                <div class="website-field" id="websiteField">
                    <label for="websiteUrl">Website URL *</label>
                    <div class="url-input-container">
                        <span class="url-prefix">https://www.</span>
                        <input type="text" id="websiteUrl" name="website_url" class="url-input" placeholder="yourwebsite.com">
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label for="email">Email Address *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="entityType">Type of Entity *</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="corporation" name="entity_type" value="corporation" required>
                            <label for="corporation">Corporation</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="llc" name="entity_type" value="llc">
                            <label for="llc">LLC</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="partnership" name="entity_type" value="partnership">
                            <label for="partnership">Partnership</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="soleProprietor" name="entity_type" value="sole_proprietor">
                            <label for="soleProprietor">Sole Proprietor</label>
                        </div>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label for="industryType">Industry Type *</label>
                        <select id="industryType" name="industry_type" required>
                            <option value="">Select a business type</option>
                            <option value="accounting">Accounting Services</option>
                            <option value="auto_repair">Auto Repair & Services</option>
                            <option value="bar_nightclub">Bar/Nightclub</option>
                            <option value="beauty_salon">Beauty Salon/Barber Shop</option>
                            <option value="chiropractor">Chiropractor</option>
                            <option value="construction">Construction</option>
                            <option value="consulting">Consulting Services</option>
                            <option value="dental">Dental Practice</option>
                            <option value="ecommerce">E-Commerce/Online Retail</option>
                            <option value="fitness">Fitness Center/Gym</option>
                            <option value="healthcare">Healthcare Services</option>
                            <option value="hotel">Hotel/Hospitality</option>
                            <option value="hvac">HVAC Services</option>
                            <option value="insurance">Insurance Agency</option>
                            <option value="landscaping">Landscaping</option>
                            <option value="law_firm">Law Firm/Legal Services</option>
                            <option value="logistics">Logistics/Trucking</option>
                            <option value="manufacturing">Manufacturing</option>
                            <option value="marketing">Marketing Agency</option>
                            <option value="medical">Medical Practice</option>
                            <option value="plumbing">Plumbing Services</option>
                            <option value="real_estate">Real Estate</option>
                            <option value="restaurant">Restaurant/Food Service</option>
                            <option value="retail">Retail Store</option>
                            <option value="roofing">Roofing</option>
                            <option value="spa">Spa/Wellness Center</option>
                            <option value="technology">Technology/IT Services</option>
                            <option value="veterinary">Veterinary Services</option>
                            <option value="wholesale">Wholesale/Distribution</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label for="additionalNotes">Additional Notes</label>
                        <textarea id="additionalNotes" name="additional_notes" placeholder="Please add any additional information or comments here."></textarea>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <div></div>
                    <button type="button" onclick="nextPageWithValidation(2)">Next Page →</button>
                </div>
            </div>

            <div class="page-section" id="page2">
                <div class="page-indicator">Page 2 of 6</div>
                <h2 class="section-title">FUNDING INFORMATION</h2>

                <div class="form-row">
                    <div class="form-group">
                        <label for="monthlyRevenue">Monthly Gross Revenue (Avg.) *</label>
                        <input type="text" id="monthlyRevenue" name="monthly_revenue" placeholder="$" required>
                    </div>
                    <div class="form-group">
                        <label for="fundingAmount">Funding Amount Request *</label>
                        <input type="text" id="fundingAmount" name="funding_amount" placeholder="$" required>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label for="fundingReason">Primary reason for seeking funding *</label>
                        <select id="fundingReason" name="funding_reason" required>
                            <option value="">Select a reason</option>
                            <option value="inventory">Inventory Purchase</option>
                            <option value="equipment">Equipment Purchase</option>
                            <option value="expansion">Business Expansion</option>
                            <option value="payroll">Payroll</option>
                            <option value="marketing">Marketing/Advertising</option>
                            <option value="renovation">Renovation/Remodeling</option>
                            <option value="emergency">Emergency Funds</option>
                            <option value="debt_consolidation">Debt Consolidation</option>
                            <option value="seasonal">Seasonal Cash Flow</option>
                            <option value="working_capital">Working Capital</option>
                            <option value="real_estate">Real Estate Purchase</option>
                            <option value="technology">Technology Upgrade</option>
                            <option value="hiring">Hiring New Employees</option>
                            <option value="franchise">Franchise Fee</option>
                            <option value="refinance">Refinance Existing Debt</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button type="button" onclick="prevPageWithValidation(1)">← Previous</button>
                    <button type="button" onclick="nextPageWithValidation(3)">Next Page →</button>
                </div>
            </div>

            <div class="page-section" id="page3">
                <div class="page-indicator">Page 3 of 6</div>
                <h2 class="section-title">MERCHANT/OWNER INFORMATION</h2>

                <div class="form-row">
                    <div class="form-group">
                        <label for="ownerName">Corporate Officer/Owner Name *</label>
                        <input type="text" id="ownerName" name="owner_name" required>
                    </div>
                    <div class="form-group">
                        <label for="ownerTitle">Title *</label>
                        <input type="text" id="ownerTitle" name="owner_title" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="ownershipPercentage">Ownership Percentage *</label>
                        <input type="number" id="ownershipPercentage" name="ownership_percentage" min="0" max="100" required>
                    </div>
                    <div class="form-group">
                        <label for="homeAddress">Home Address *</label>
                        <input type="text" id="homeAddress" name="home_address" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="ownerCity">City *</label>
                        <input type="text" id="ownerCity" name="owner_city" required>
                    </div>
                    <div class="form-group">
                        <label for="ownerState">State *</label>
                        <select id="ownerState" name="owner_state" required>
                            <option value="">Select State</option>
                            <option value="AL">Alabama</option>
                            <option value="AK">Alaska</option>
                            <option value="AZ">Arizona</option>
                            <option value="AR">Arkansas</option>
                            <option value="CA">California</option>
                            <option value="CO">Colorado</option>
                            <option value="CT">Connecticut</option>
                            <option value="DE">Delaware</option>
                            <option value="FL">Florida</option>
                            <option value="GA">Georgia</option>
                            <option value="HI">Hawaii</option>
                            <option value="ID">Idaho</option>
                            <option value="IL">Illinois</option>
                            <option value="IN">Indiana</option>
                            <option value="IA">Iowa</option>
                            <option value="KS">Kansas</option>
                            <option value="KY">Kentucky</option>
                            <option value="LA">Louisiana</option>
                            <option value="ME">Maine</option>
                            <option value="MD">Maryland</option>
                            <option value="MA">Massachusetts</option>
                            <option value="MI">Michigan</option>
                            <option value="MN">Minnesota</option>
                            <option value="MS">Mississippi</option>
                            <option value="MO">Missouri</option>
                            <option value="MT">Montana</option>
                            <option value="NE">Nebraska</option>
                            <option value="NV">Nevada</option>
                            <option value="NH">New Hampshire</option>
                            <option value="NJ">New Jersey</option>
                            <option value="NM">New Mexico</option>
                            <option value="NY">New York</option>
                            <option value="NC">North Carolina</option>
                            <option value="ND">North Dakota</option>
                            <option value="OH">Ohio</option>
                            <option value="OK">Oklahoma</option>
                            <option value="OR">Oregon</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="RI">Rhode Island</option>
                            <option value="SC">South Carolina</option>
                            <option value="SD">South Dakota</option>
                            <option value="TN">Tennessee</option>
                            <option value="TX">Texas</option>
                            <option value="UT">Utah</option>
                            <option value="VT">Vermont</option>
                            <option value="VA">Virginia</option>
                            <option value="WA">Washington</option>
                            <option value="WV">West Virginia</option>
                            <option value="WI">Wisconsin</option>
                            <option value="WY">Wyoming</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="ownerZip">Zip *</label>
                        <input type="text" id="ownerZip" name="owner_zip" required>
                    </div>
                    <div class="form-group">
                        <label for="ssn">Social Security Number (SSN) *</label>
                        <input type="text" id="ssn" name="ssn" placeholder="XXX-XX-XXXX" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="dob">Date of Birth *</label>
                        <input type="date" id="dob" name="dob" required>
                    </div>
                    <div class="form-group">
                        <label for="ficoScore">FICO Credit Score *</label>
                        <input type="number" id="ficoScore" name="fico_score" min="300" max="850" required>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button type="button" onclick="prevPageWithValidation(2)">← Previous</button>
                    <button type="button" onclick="nextPageWithValidation(4)">Next Page →</button>
                </div>
            </div>

            <div class="page-section" id="page4">
                <div class="page-indicator">Page 4 of 6</div>
                <h2 class="section-title">ADDITIONAL OWNERS</h2>

                <div class="form-group">
                    <label>Are there any additional owners with 20% or more ownership? *</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="additionalOwnersYes" name="additional_owners" value="yes" required>
                            <label for="additionalOwnersYes">Yes</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="additionalOwnersNo" name="additional_owners" value="no">
                            <label for="additionalOwnersNo">No</label>
                        </div>
                    </div>
                </div>

                <div id="additionalOwnersSection" style="display: none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="additionalOwnerName">Additional Owner Name</label>
                            <input type="text" id="additionalOwnerName" name="additional_owner_name">
                        </div>
                        <div class="form-group">
                            <label for="additionalOwnerTitle">Title</label>
                            <input type="text" id="additionalOwnerTitle" name="additional_owner_title">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="additionalOwnerPercentage">Ownership Percentage</label>
                            <input type="number" id="additionalOwnerPercentage" name="additional_owner_percentage" min="0" max="100">
                        </div>
                        <div class="form-group">
                            <label for="additionalOwnerSSN">Social Security Number</label>
                            <input type="text" id="additionalOwnerSSN" name="additional_owner_ssn" placeholder="XXX-XX-XXXX">
                        </div>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button type="button" onclick="prevPageWithValidation(3)">← Previous</button>
                    <button type="button" onclick="nextPageWithValidation(5)">Next Page →</button>
                </div>
            </div>

            <div class="page-section" id="page5">
                <div class="page-indicator">Page 5 of 6</div>
                <h2 class="section-title">DOCUMENT UPLOAD</h2>

                <div class="upload-section">
                    <div class="upload-item">
                        <label for="bankStatements">Bank Statements (Last 4 months) *</label>
                        <input type="file" id="bankStatements" name="bank_statements" accept=".pdf,.jpg,.jpeg,.png" required>
                    </div>

                    <div class="upload-item">
                        <label for="driverLicense">Driver's License or State ID *</label>
                        <input type="file" id="driverLicense" name="driver_license" accept=".pdf,.jpg,.jpeg,.png" required>
                    </div>

                    <div class="upload-item">
                        <label for="voidedCheck">Voided Business Check *</label>
                        <input type="file" id="voidedCheck" name="voided_check" accept=".pdf,.jpg,.jpeg,.png" required>
                    </div>

                    <div class="upload-item">
                        <label for="additionalDocuments">Additional Documents (if any)</label>
                        <input type="file" id="additionalDocuments" name="additional_documents" accept=".pdf,.jpg,.jpeg,.png">
                        <small>You may upload any other relevant documents such as business licenses, articles of incorporation, etc.</small>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button type="button" onclick="prevPageWithValidation(4)">← Previous</button>
                    <button type="button" onclick="nextPageWithValidation(6)">Next Page →</button>
                </div>
            </div>

            <div class="page-section" id="page6">
                <div class="page-indicator">Page 6 of 6</div>
                <h2 class="section-title">REVIEW & SUBMIT</h2>

                <div class="animated-banner">
                    <h3><span class="pointer">👇</span> IMPORTANT: PLEASE REVIEW YOUR INFORMATION CAREFULLY</h3>
                    <p>Before submitting, ensure all information is accurate and complete.</p>
                </div>

                <div class="disclaimer-text">
                    <h4>DISCLOSURE STATEMENT</h4>
                    <p>By submitting this application, you authorize Express Capital Associates to obtain consumer or commercial credit reports, and other information about you and your business from one or more consumer reporting agencies and other third parties. You understand that this application is subject to Express Capital Associates' underwriting criteria and that submission of this application does not guarantee approval for funding.</p>
                    <p>You certify that the information provided in this application is true and correct to the best of your knowledge. You understand that any misrepresentation may result in denial of funding and/or termination of any funding agreement.</p>
                </div>

                <div class="acknowledge-checkbox">
                    <input type="checkbox" id="acknowledge" name="acknowledge" required>
                    <label for="acknowledge">I acknowledge that I have read and understand the above disclosure statement and certify that all information provided in this application is true and accurate to the best of my knowledge.</label>
                </div>

                <div class="signature-section">
                    <h4>ELECTRONIC SIGNATURE</h4>
                    <p>Please provide your electronic signature below:</p>
                    
                    <div id="signaturePadContainer">
                        <canvas id="signatureCanvas"></canvas>
                    </div>
                    
                    <div class="signature-required" id="signatureRequired">* Signature is required</div>
                    <div style="margin-top: 10px;">
                        <button type="button" id="clearSignatureBtn">Clear Signature</button>
                    </div>
                </div>

                <div class="navigation-buttons">
                    <button type="button" onclick="prevPageWithValidation(5)">← Previous</button>
                    <button type="button" id="submitBtn" onclick="submitApplication()">Submit Application</button>
                </div>
            </div>
        </form>

        <div class="action-buttons">
            <button type="button" onclick="printApplication()">Print Application</button>
        </div>

        <div class="success-message" id="successMessage">
            <h3>Thank you for submitting your application!</h3>
            <p>We will contact you within a few hours.</p>
        </div>
    </div>

    <script>
        let signaturePadInstance;
        const signatureCanvas = document.getElementById('signatureCanvas');

        // Utility function to convert Data URL (Base64) to a Blob (file-like object)
        // This is necessary to append it to FormData as a proper file attachment.
        function dataURLtoBlob(dataurl) {
            const arr = dataurl.split(',');
            const mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);
            while(n--){
                u8arr[n] = bstr.charCodeAt(n);
            }
            return new Blob([u8arr], {type:mime});
        }


        function resizeCanvas() {
            // Adjust canvas to fit the container size
            const ratio = Math.max(window.devicePixelRatio || 1, 1);
            signatureCanvas.width = signatureCanvas.offsetWidth * ratio;
            signatureCanvas.height = signatureCanvas.offsetHeight * ratio;
            signatureCanvas.getContext('2d').scale(ratio, ratio);
            
            // Re-initialize SignaturePad if it exists and clear it
            if (signaturePadInstance) {
                signaturePadInstance.clear();
            }
        }

        function initSignaturePad() {
            // Initialize the SignaturePad instance
            signaturePadInstance = new SignaturePad(signatureCanvas, {
                backgroundColor: 'rgb(255, 255, 255)',
                penColor: 'rgb(36, 52, 94)'
            });

            // Handle window resize for responsiveness
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas(); // Initial call

            // Event listener for the Clear button
            document.getElementById('clearSignatureBtn').addEventListener('click', function() {
                signaturePadInstance.clear();
                document.getElementById('signatureRequired').style.display = 'block';
            });
        }

        // Page navigation functions
        function nextPage(next) {
            const currentPage = document.querySelector('.page-section.active');
            currentPage.classList.remove('active');
            
            const nextPage = document.getElementById('page' + next);
            nextPage.classList.add('active');
        }
        
        function prevPage(prev) {
            const currentPage = document.querySelector('.page-section.active');
            currentPage.classList.remove('active');
            
            const prevPage = document.getElementById('page' + prev);
            prevPage.classList.add('active');
        }

        // Enhanced navigation with validation
        function nextPageWithValidation(next) {
            const currentPageNum = parseInt(document.querySelector('.page-section.active').id.replace('page', ''));
            
            if (validateCurrentPage(currentPageNum)) {
                nextPage(next);
            } else {
                alert('Please fill in all required fields before proceeding.');
            }
        }

        function prevPageWithValidation(prev) {
            prevPage(prev);
        }

        // Form validation for current page
        function validateCurrentPage(pageNum) {
            const currentPage = document.getElementById('page' + pageNum);
            const requiredFields = currentPage.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                // Skip validation for fields in a hidden section unless it's Page 6
                if (field.closest('.page-section') !== currentPage && pageNum !== 6) return;
                
                if (!field.value.trim()) {
                    isValid = false;
                    field.style.borderColor = 'red';
                } else {
                    field.style.borderColor = '#24345e';
                }
                
                // Special validation for website URL if "Yes" is selected
                if (pageNum === 1 && field.name === 'has_website' && field.value === 'yes') {
                    const websiteUrl = document.getElementById('websiteUrl');
                    // Check if websiteUrl is required AND empty (this happens if "Yes" is checked)
                    if (websiteUrl.hasAttribute('required') && !websiteUrl.value.trim()) {
                        isValid = false;
                        websiteUrl.style.borderColor = 'red';
                    } else {
                        websiteUrl.style.borderColor = '#24345e';
                    }
                }
            });
            
            return isValid;
        }

        // Set today's date as default and initialize
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('todayDate').value = today;
            
            initSignaturePad(); // Initialize the new pad
            
            // NEW LOGIC: Tie signature pad visibility to the main acknowledgment checkbox
            document.getElementById('acknowledge').addEventListener('change', function() {
                const container = document.getElementById('signaturePadContainer');
                const requiredText = document.getElementById('signatureRequired');
                
                if (this.checked) {
                    container.style.display = 'block';
                    resizeCanvas(); 
                    if (signaturePadInstance.isEmpty()) {
                        requiredText.style.display = 'block'; 
                    }
                } else {
                    container.style.display = 'none';
                    signaturePadInstance.clear(); // Clear the signature if they uncheck the main acknowledgement
                    requiredText.style.display = 'none';
                }
            });
            
            // Set up additional owners toggle
            document.querySelectorAll('input[name="additional_owners"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const additionalSection = document.getElementById('additionalOwnersSection');
                    if (this.value === 'yes') {
                        additionalSection.style.display = 'block';
                    } else {
                        additionalSection.style.display = 'none';
                    }
                });
            });
            
            // Set up website field toggle
            document.querySelectorAll('input[name="has_website"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const websiteField = document.getElementById('websiteField');
                    if (this.value === 'yes') {
                        websiteField.style.display = 'block';
                        document.getElementById('websiteUrl').setAttribute('required', 'required');
                    } else {
                        websiteField.style.display = 'none';
                        document.getElementById('websiteUrl').removeAttribute('required');
                    }
                });
            });
        });

        // Application submission
        function submitApplication() {
            // Check if full acknowledgement is checked (REQUIRED)
            if (!document.getElementById('acknowledge').checked) {
                alert('Please acknowledge the disclosure statement.');
                return;
            }
            
            // SIGNATURE CHECK: Use the native isEmpty() check before submission
            if (signaturePadInstance.isEmpty()) {
                document.getElementById('signatureRequired').style.display = 'block';
                alert('Please provide your electronic signature.');
                return;
            }
            
            // Hide the required message if the signature passed the check
            document.getElementById('signatureRequired').style.display = 'none';
            
            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            // 1. Create FormData object from the form
            const form = document.getElementById('applicationForm');
            const formData = new FormData(form);
            
            // 2. Convert signature to PNG Data URL
            const dataURL = signaturePadInstance.toDataURL("image/png"); 
            
            // 3. Convert Data URL to Blob (file-like object)
            const signatureBlob = dataURLtoBlob(dataURL);
            
            // 4. APPEND THE BLOB TO THE FORM DATA AS A FILE (This is the fix for Formspree)
            // Formspree recognizes the third argument ('signature.png') as the filename for the attachment.
            formData.append('signature_file', signatureBlob, 'signature.png');

            // Add website URL with prefix if applicable
            if (document.getElementById('websiteYes').checked && document.getElementById('websiteUrl').value) {
                formData.set('website_url', 'https://www.' + document.getElementById('websiteUrl').value);
            }
            
            // Submitting the form with the new FormData object that includes the signature file
            fetch(form.action, {
                method: 'POST',
                body: formData, // Send the FormData object containing the signature file
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    // Show success message
                    document.getElementById('applicationForm').style.display = 'none';
                    document.querySelector('.action-buttons').style.display = 'none';
                    document.getElementById('successMessage').style.display = 'block';
                    window.scrollTo(0, 0); // Scroll to top for success message
                } else {
                    alert('There was an error submitting your application. Please try again.');
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit Application';
                }
            })
            .catch(error => {
                alert('There was an error submitting your application. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Application';
            });
        }

        // Print application
        function printApplication() {
            window.print();
        }
    </script>
</body>
</html>
